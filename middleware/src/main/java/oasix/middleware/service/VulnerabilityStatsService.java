package oasix.middleware.service;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import oasix.middleware.model.ConnectionStats;
import oasix.middleware.model.VulnerabilityStats;
import oasix.middleware.repository.VulnerabilityStatsRepository;

@Component
public class VulnerabilityStatsService {
	@Autowired
	VulnerabilityStatsRepository vulnerabilityStatsRepository;
		
	public void aggregate(Date analysisTime){
		List<VulnerabilityStats> stats = new ArrayList<>();
		String host = "govmu.org";
		stats.add(new VulnerabilityStats(host, analysisTime, 12, "APPLICATION" ,"MAJOR"));
		stats.add(new VulnerabilityStats(host, analysisTime, 4, "ADMINISTRATION" ,"CRITICAL"));
		stats.add(new VulnerabilityStats(host, analysisTime, 12, "APPLICATION", "MINOR"));
		vulnerabilityStatsRepository.save(stats);
	}
	
	public void cleanup() {
		vulnerabilityStatsRepository.delete(vulnerabilityStatsRepository.findAll());
	}
}
